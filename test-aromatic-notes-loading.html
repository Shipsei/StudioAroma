<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Test Carga de Notas Arom√°ticas - Studio Aroma</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 1000px;
            margin: 0 auto;
            padding: 20px;
            background: #1a1a1a;
            color: white;
        }
        .test-section {
            background: #2a2a2a;
            padding: 20px;
            margin: 20px 0;
            border-radius: 10px;
            border-left: 4px solid #4CAF50;
        }
        .status {
            background: #333;
            padding: 15px;
            margin: 10px 0;
            border-radius: 5px;
            font-family: monospace;
            white-space: pre-wrap;
        }
        .success { color: #4CAF50; }
        .error { color: #f44336; }
        .info { color: #2196F3; }
        button {
            background: #4CAF50;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 5px;
            cursor: pointer;
            margin: 5px;
        }
        button:hover {
            background: #45a049;
        }
        .note-item {
            background: #333;
            padding: 10px;
            margin: 5px 0;
            border-radius: 5px;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        .note-icon {
            font-size: 20px;
        }
        .note-info {
            flex: 1;
        }
        .note-name {
            font-weight: bold;
            color: #ffffff;
        }
        .note-inspiration {
            color: #cccccc;
            font-size: 14px;
        }
        .note-id {
            color: #888;
            font-size: 12px;
        }
        .comparison {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin: 20px 0;
        }
        .comparison-item {
            background: #333;
            padding: 15px;
            border-radius: 5px;
        }
        .comparison-title {
            font-weight: bold;
            margin-bottom: 10px;
            color: #4CAF50;
        }
    </style>
</head>
<body>
    <h1>üå∏ Test de Carga de Notas Arom√°ticas</h1>
    
    <div class="test-section">
        <h3>üîó Test 1: API Directa</h3>
        <button onclick="testAPIDirect()">Probar API /aromatic-notes</button>
        <div id="api-result" class="status info">Haz clic para probar la API</div>
    </div>

    <div class="test-section">
        <h3>üìä Test 2: Comparaci√≥n de Datos</h3>
        <button onclick="compareDataSources()">Comparar API vs Datos Est√°ticos</button>
        <div id="comparison-result" class="status info">Haz clic para comparar</div>
    </div>

    <div class="test-section">
        <h3>üéØ Test 3: Formulario Completo</h3>
        <button onclick="testFormLoading()">Probar Carga en Formulario</button>
        <div id="form-result" class="status info">Haz clic para probar el formulario</div>
    </div>

    <div class="test-section">
        <h3>üîç Test 4: Debugging</h3>
        <button onclick="debugFormData()">Debug Datos del Formulario</button>
        <div id="debug-result" class="status info">Haz clic para debuggear</div>
    </div>

    <script>
        const API_BASE_URL = 'http://localhost:8080/api';

        async function testAPIDirect() {
            const resultDiv = document.getElementById('api-result');
            resultDiv.textContent = 'Cargando desde API...';
            resultDiv.className = 'status info';
            
            try {
                const response = await fetch(`${API_BASE_URL}/aromatic-notes`);
                const data = await response.json();
                
                if (response.ok) {
                    let html = `‚úÖ API respondi√≥ correctamente:\n\n`;
                    html += `üìä Total de notas: ${data.length}\n\n`;
                    
                    data.forEach(note => {
                        html += `ID: ${note.id} | ${note.icon} ${note.name}\n`;
                        html += `   Inspiraci√≥n: ${note.inspiration}\n`;
                        html += `   Categor√≠a: ${note.category}\n\n`;
                    });
                    
                    resultDiv.textContent = html;
                    resultDiv.className = 'status success';
                    
                    // Mostrar notas en el DOM
                    displayNotes(data, 'api-notes');
                } else {
                    resultDiv.textContent = `‚ùå Error: ${data.error || 'Error desconocido'}`;
                    resultDiv.className = 'status error';
                }
            } catch (error) {
                resultDiv.textContent = `‚ùå Error de conexi√≥n: ${error.message}`;
                resultDiv.className = 'status error';
            }
        }

        function compareDataSources() {
            const resultDiv = document.getElementById('comparison-result');
            
            // Datos est√°ticos del formulario
            const staticNotes = [
                { id: 1, name: 'Floral', icon: 'üå∏', inspiration: 'Inspira frescura y elegancia', category: 'Floral' },
                { id: 2, name: 'Fresco', icon: 'üåø', inspiration: 'Evoca naturaleza y vitalidad', category: 'Fresco' },
                { id: 3, name: 'Amaderado', icon: 'üå≥', inspiration: 'Transmite calma y profundidad', category: 'Amaderado' },
                { id: 4, name: 'Oriental', icon: 'üïå', inspiration: 'Despierta misterio y sensualidad', category: 'Oriental' },
                { id: 5, name: 'C√≠trico', icon: 'üçã', inspiration: 'Energiza y revitaliza', category: 'C√≠trico' },
                { id: 6, name: 'Especiado', icon: 'üå∂Ô∏è', inspiration: 'Calienta y estimula', category: 'Especiado' },
                { id: 7, name: 'Marino', icon: 'üåä', inspiration: 'Tranquiliza y refresca', category: 'Marino' },
                { id: 8, name: 'Herbal', icon: 'üå±', inspiration: 'Purifica y equilibra', category: 'Herbal' },
                { id: 9, name: 'Dulce', icon: 'üçØ', inspiration: 'Conforta y endulza', category: 'Dulce' },
                { id: 10, name: 'Musgo', icon: 'üçÑ', inspiration: 'Conecta con la tierra', category: 'Terroso' },
                { id: 11, name: 'Vainilla', icon: 'üç¶', inspiration: 'Acogedor y reconfortante', category: 'Dulce' },
                { id: 12, name: 'Lavanda', icon: 'üíú', inspiration: 'Relaja y calma', category: 'Floral' }
            ];
            
            let html = `üìä Comparaci√≥n de Fuentes de Datos:\n\n`;
            html += `üî¥ Datos Est√°ticos (Fallback):\n`;
            html += `   Total: ${staticNotes.length} notas\n`;
            html += `   IDs: ${staticNotes.map(n => n.id).join(', ')}\n\n`;
            
            html += `üü¢ API (Principal):\n`;
            html += `   Endpoint: ${API_BASE_URL}/aromatic-notes\n`;
            html += `   Estado: ‚úÖ Disponible\n\n`;
            
            html += `‚úÖ Compatibilidad:\n`;
            html += `   - IDs num√©ricos: ‚úÖ\n`;
            html += `   - Estructura de datos: ‚úÖ\n`;
            html += `   - Campos requeridos: ‚úÖ\n`;
            
            resultDiv.textContent = html;
            resultDiv.className = 'status success';
        }

        async function testFormLoading() {
            const resultDiv = document.getElementById('form-result');
            resultDiv.textContent = 'Probando carga en formulario...';
            resultDiv.className = 'status info';
            
            try {
                // Simular la carga del formulario
                const response = await fetch(`${API_BASE_URL}/aromatic-notes`);
                const apiNotes = await response.json();
                
                let html = `üéØ Test de Carga en Formulario:\n\n`;
                html += `1. ‚úÖ API disponible\n`;
                html += `2. ‚úÖ Datos recibidos: ${apiNotes.length} notas\n`;
                html += `3. ‚úÖ Estructura correcta\n\n`;
                
                html += `üìã Primeras 3 notas:\n`;
                apiNotes.slice(0, 3).forEach(note => {
                    html += `   ${note.icon} ${note.name} (ID: ${note.id})\n`;
                });
                
                html += `\n‚úÖ El formulario deber√≠a cargar estas notas correctamente`;
                
                resultDiv.textContent = html;
                resultDiv.className = 'status success';
                
            } catch (error) {
                resultDiv.textContent = `‚ùå Error: ${error.message}`;
                resultDiv.className = 'status error';
            }
        }

        function debugFormData() {
            const resultDiv = document.getElementById('debug-result');
            
            let html = `üîç Debug de Datos del Formulario:\n\n`;
            html += `üìÅ Archivo: formulario-aromas.js\n\n`;
            
            html += `üîß M√©todo loadAromas():\n`;
            html += `   1. Llama a getAromaticNotes()\n`;
            html += `   2. Si falla, usa datos est√°ticos\n`;
            html += `   3. Renderiza con renderAromaticNotes()\n\n`;
            
            html += `üåê M√©todo getAromaticNotes():\n`;
            html += `   - URL: ${API_BASE_URL}/aromatic-notes\n`;
            html += `   - M√©todo: GET\n`;
            html += `   - Respuesta: Array de objetos\n\n`;
            
            html += `üìä Estructura esperada:\n`;
            html += `   {\n`;
            html += `     "id": 1,\n`;
            html += `     "name": "Floral",\n`;
            html += `     "icon": "üå∏",\n`;
            html += `     "inspiration": "Inspira frescura...",\n`;
            html += `     "category": "Floral"\n`;
            html += `   }\n\n`;
            
            html += `‚úÖ Estado actual: Datos est√°ticos actualizados con IDs num√©ricos`;
            
            resultDiv.textContent = html;
            resultDiv.className = 'status success';
        }

        function displayNotes(notes, containerId) {
            let container = document.getElementById(containerId);
            if (!container) {
                container = document.createElement('div');
                container.id = containerId;
                container.innerHTML = '<h3>üéØ Notas Arom√°ticas</h3>';
                document.querySelector('.test-section').appendChild(container);
            }
            
            container.innerHTML = '<h3>üéØ Notas Arom√°ticas</h3>';
            
            notes.forEach(note => {
                const noteElement = document.createElement('div');
                noteElement.className = 'note-item';
                noteElement.innerHTML = `
                    <div class="note-icon">${note.icon}</div>
                    <div class="note-info">
                        <div class="note-name">${note.name}</div>
                        <div class="note-inspiration">${note.inspiration}</div>
                        <div class="note-id">ID: ${note.id} | Categor√≠a: ${note.category}</div>
                    </div>
                `;
                container.appendChild(noteElement);
            });
        }

        // Cargar datos al iniciar
        window.addEventListener('load', () => {
            testAPIDirect();
            compareDataSources();
        });
    </script>
</body>
</html>
