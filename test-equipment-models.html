<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Test Modelos de Equipos - Studio Aroma</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 1000px;
            margin: 0 auto;
            padding: 20px;
            background: #1a1a1a;
            color: white;
        }
        .test-section {
            background: #2a2a2a;
            padding: 20px;
            margin: 20px 0;
            border-radius: 10px;
            border-left: 4px solid #4CAF50;
        }
        .test-result {
            background: #333;
            padding: 15px;
            margin: 10px 0;
            border-radius: 5px;
            font-family: monospace;
            white-space: pre-wrap;
            max-height: 300px;
            overflow-y: auto;
        }
        .success { border-left-color: #4CAF50; }
        .error { border-left-color: #f44336; }
        .info { border-left-color: #2196F3; }
        button {
            background: #4CAF50;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 5px;
            cursor: pointer;
            margin: 5px;
        }
        button:hover {
            background: #45a049;
        }
        .equipment-card {
            background: #333;
            padding: 15px;
            margin: 10px 0;
            border-radius: 8px;
            border-left: 4px solid #4CAF50;
        }
        .equipment-image {
            width: 100px;
            height: 100px;
            background: #555;
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 10px 0;
            font-size: 24px;
        }
    </style>
</head>
<body>
    <h1>ðŸ”§ Test de Modelos de Equipos - Studio Aroma</h1>
    
    <div class="test-section info">
        <h3>ðŸ“‹ Nueva Funcionalidad</h3>
        <p>Se agregÃ³ la tabla <strong>equipment_models</strong> para almacenar informaciÃ³n detallada de los modelos de equipos, incluyendo:</p>
        <ul>
            <li>âœ… <strong>Nombre del modelo</strong></li>
            <li>âœ… <strong>Imagen del equipo</strong></li>
            <li>âœ… <strong>DescripciÃ³n</strong></li>
            <li>âœ… <strong>Tipo de difusor</strong></li>
            <li>âœ… <strong>Especificaciones tÃ©cnicas</strong></li>
        </ul>
    </div>

    <div class="test-section">
        <h3>ðŸ”— Test 1: Obtener Modelos de Equipos</h3>
        <button onclick="testGetEquipmentModels()">Obtener Todos los Modelos</button>
        <div id="models-result" class="test-result"></div>
    </div>

    <div class="test-section">
        <h3>ðŸ“± Test 2: Obtener Equipo con Modelo</h3>
        <button onclick="testGetEquipmentWithModel(1)">Equipo ID 1</button>
        <button onclick="testGetEquipmentWithModel(2)">Equipo ID 2</button>
        <div id="equipment-result" class="test-result"></div>
    </div>

    <div class="test-section">
        <h3>ðŸŽ¯ Test 3: Formulario con Nuevos Datos</h3>
        <button onclick="testFormWithNewData()">Probar Formulario</button>
        <div id="form-result" class="test-result"></div>
    </div>

    <div class="test-section">
        <h3>ðŸ“Š Test 4: Comparar Datos Antes/DespuÃ©s</h3>
        <button onclick="compareData()">Comparar Estructura</button>
        <div id="compare-result" class="test-result"></div>
    </div>

    <script>
        const API_BASE_URL = 'http://localhost:8080/api';

        async function testGetEquipmentModels() {
            const resultDiv = document.getElementById('models-result');
            resultDiv.textContent = 'Cargando modelos de equipos...';
            
            try {
                const response = await fetch(`${API_BASE_URL}/equipment-models`);
                const data = await response.json();
                
                if (response.ok) {
                    let html = `âœ… ${data.length} modelos encontrados:\n\n`;
                    
                    data.forEach(model => {
                        html += `ðŸ“± ${model.name}\n`;
                        html += `   Tipo: ${model.type}\n`;
                        html += `   DescripciÃ³n: ${model.description}\n`;
                        html += `   Imagen: ${model.image}\n`;
                        html += `   Especificaciones: ${JSON.stringify(model.specifications, null, 2)}\n\n`;
                    });
                    
                    resultDiv.textContent = html;
                    resultDiv.parentElement.className = 'test-section success';
                } else {
                    resultDiv.textContent = `âŒ Error: ${data.error || 'Error desconocido'}`;
                    resultDiv.parentElement.className = 'test-section error';
                }
            } catch (error) {
                resultDiv.textContent = `âŒ Error de conexiÃ³n: ${error.message}`;
                resultDiv.parentElement.className = 'test-section error';
            }
        }

        async function testGetEquipmentWithModel(id) {
            const resultDiv = document.getElementById('equipment-result');
            resultDiv.textContent = `Cargando equipo ID ${id}...`;
            
            try {
                const response = await fetch(`${API_BASE_URL}/equipment/${id}`);
                const data = await response.json();
                
                if (response.ok) {
                    let html = `âœ… Equipo ${id} cargado:\n\n`;
                    html += `ðŸ“± Modelo: ${data.model}\n`;
                    html += `ðŸ“ UbicaciÃ³n: ${data.location}\n`;
                    html += `ðŸ“… Instalado: ${data.installation_date}\n\n`;
                    
                    if (data.equipment_model) {
                        html += `ðŸ”§ InformaciÃ³n del Modelo:\n`;
                        html += `   Nombre: ${data.equipment_model.name}\n`;
                        html += `   Tipo: ${data.equipment_model.type}\n`;
                        html += `   DescripciÃ³n: ${data.equipment_model.description}\n`;
                        html += `   Imagen: ${data.equipment_model.image}\n`;
                        html += `   Especificaciones: ${JSON.stringify(data.equipment_model.specifications, null, 2)}\n\n`;
                    } else {
                        html += `âš ï¸ No hay informaciÃ³n del modelo asociado\n\n`;
                    }
                    
                    if (data.aroma) {
                        html += `ðŸŒ¸ Aroma Asignado:\n`;
                        html += `   Nombre: ${data.aroma.name}\n`;
                        html += `   CategorÃ­a: ${data.aroma.category}\n`;
                        html += `   Notas: ${data.aroma.notes.join(', ')}\n`;
                    }
                    
                    resultDiv.textContent = html;
                    resultDiv.parentElement.className = 'test-section success';
                } else {
                    resultDiv.textContent = `âŒ Error: ${data.error || 'Error desconocido'}`;
                    resultDiv.parentElement.className = 'test-section error';
                }
            } catch (error) {
                resultDiv.textContent = `âŒ Error de conexiÃ³n: ${error.message}`;
                resultDiv.parentElement.className = 'test-section error';
            }
        }

        async function testFormWithNewData() {
            const resultDiv = document.getElementById('form-result');
            resultDiv.textContent = 'Probando formulario con nuevos datos...';
            
            try {
                // Simular carga de datos del formulario
                const equipmentResponse = await fetch(`${API_BASE_URL}/equipment/1`);
                const equipmentData = await equipmentResponse.json();
                
                if (equipmentResponse.ok) {
                    let html = `âœ… Formulario cargado correctamente:\n\n`;
                    html += `ðŸ“± Datos del Equipo:\n`;
                    html += `   ID: ${equipmentData.id}\n`;
                    html += `   Modelo: ${equipmentData.model}\n`;
                    html += `   UbicaciÃ³n: ${equipmentData.location}\n\n`;
                    
                    if (equipmentData.equipment_model) {
                        html += `ðŸ”§ Datos del Modelo:\n`;
                        html += `   Nombre: ${equipmentData.equipment_model.name}\n`;
                        html += `   DescripciÃ³n: ${equipmentData.equipment_model.description}\n`;
                        html += `   Tipo: ${equipmentData.equipment_model.type}\n`;
                        html += `   Imagen: ${equipmentData.equipment_model.image}\n\n`;
                    }
                    
                    html += `ðŸŒ¸ Aroma Asignado:\n`;
                    html += `   Nombre: ${equipmentData.aroma.name}\n`;
                    html += `   Notas: ${equipmentData.aroma.notes.join(', ')}\n\n`;
                    
                    html += `âœ… El formulario ahora puede mostrar:\n`;
                    html += `   - Nombre del modelo desde equipment_models\n`;
                    html += `   - DescripciÃ³n del equipo\n`;
                    html += `   - Especificaciones tÃ©cnicas\n`;
                    html += `   - Imagen del equipo\n`;
                    
                    resultDiv.textContent = html;
                    resultDiv.parentElement.className = 'test-section success';
                } else {
                    resultDiv.textContent = `âŒ Error cargando equipo: ${equipmentData.error}`;
                    resultDiv.parentElement.className = 'test-section error';
                }
            } catch (error) {
                resultDiv.textContent = `âŒ Error: ${error.message}`;
                resultDiv.parentElement.className = 'test-section error';
            }
        }

        async function compareData() {
            const resultDiv = document.getElementById('compare-result');
            resultDiv.textContent = 'Comparando estructura de datos...';
            
            try {
                const response = await fetch(`${API_BASE_URL}/equipment/1`);
                const data = await response.json();
                
                if (response.ok) {
                    let html = `ðŸ“Š ComparaciÃ³n de Estructura de Datos:\n\n`;
                    
                    html += `ðŸ”´ ANTES (solo equipment):\n`;
                    html += `   - model: "StudioAroma Pro 500"\n`;
                    html += `   - type: "UltrasÃ³nico"\n`;
                    html += `   - location: "Av. Reforma 123..."\n\n`;
                    
                    html += `ðŸŸ¢ DESPUÃ‰S (equipment + equipment_model):\n`;
                    html += `   - model: "StudioAroma Pro 500" (legacy)\n`;
                    html += `   - equipment_model.name: "StudioAroma Pro 500"\n`;
                    html += `   - equipment_model.description: "Difusor ultrasÃ³nico profesional..."\n`;
                    html += `   - equipment_model.image: "/images/equipment/pro-500.jpg"\n`;
                    html += `   - equipment_model.specifications: {\n`;
                    html += `       "capacidad": "500ml",\n`;
                    html += `       "cobertura": "100mÂ²",\n`;
                    html += `       "funciones": ["Timer", "LED", "HumidificaciÃ³n"]\n`;
                    html += `     }\n\n`;
                    
                    html += `âœ… Beneficios:\n`;
                    html += `   - InformaciÃ³n mÃ¡s detallada del equipo\n`;
                    html += `   - Especificaciones tÃ©cnicas completas\n`;
                    html += `   - ImÃ¡genes para mostrar en el formulario\n`;
                    html += `   - Descripciones profesionales\n`;
                    html += `   - ReutilizaciÃ³n de modelos para mÃºltiples equipos\n`;
                    
                    resultDiv.textContent = html;
                    resultDiv.parentElement.className = 'test-section success';
                } else {
                    resultDiv.textContent = `âŒ Error: ${data.error}`;
                    resultDiv.parentElement.className = 'test-section error';
                }
            } catch (error) {
                resultDiv.textContent = `âŒ Error: ${error.message}`;
                resultDiv.parentElement.className = 'test-section error';
            }
        }

        // Cargar datos al iniciar
        window.addEventListener('load', () => {
            testGetEquipmentModels();
        });
    </script>
</body>
</html>
